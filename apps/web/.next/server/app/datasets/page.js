(()=>{var e={};e.id=214,e.ids=[214],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},14503:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o});var t=a(42361),r=a(16718),n=a(52712),i=a.n(n),l=a(82159),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);a.d(s,d);let o=["",{children:["datasets",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,61381)),"/Users/bastienverdier-vaissiere/Documents/Baverdie/Code/Projet Pro/SalesScope/apps/web/src/app/datasets/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,82118)),"/Users/bastienverdier-vaissiere/Documents/Baverdie/Code/Projet Pro/SalesScope/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,14884,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/bastienverdier-vaissiere/Documents/Baverdie/Code/Projet Pro/SalesScope/apps/web/src/app/datasets/page.tsx"],x={require:a,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/datasets/page",pathname:"/datasets",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},21922:(e,s,a)=>{Promise.resolve().then(a.bind(a,61381))},40074:(e,s,a)=>{Promise.resolve().then(a.bind(a,19503))},19503:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>h});var t=a(76675),r=a(11072),n=a(22221),i=a(91922),l=a(99628),d=a(62473),o=a(6070),c=a(84559),x=a(23174),u=a(83456);function m({onSuccess:e}){let[s,a]=(0,o.useState)(null),[r,n]=(0,o.useState)(""),[d,c]=(0,o.useState)(!1),m=(0,i.Zj)(),p=(0,o.useCallback)(e=>{e.preventDefault(),c(!0)},[]),h=(0,o.useCallback)(e=>{e.preventDefault(),c(!1)},[]),g=(0,o.useCallback)(e=>{e.preventDefault(),c(!1);let s=e.dataTransfer.files[0];s&&s.name.endsWith(".csv")?(a(s),r||n(s.name.replace(".csv",""))):alert("Please upload a CSV file")},[r]),v=async t=>{if(t.preventDefault(),!s)return;let i=r||s.name.replace(".csv","");m.mutate({name:i,file:s},{onSuccess:()=>{a(null),n(""),e?.()}})};return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload CSV File"}),(0,t.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.J,{htmlFor:"datasetName",children:"Dataset Name"}),(0,t.jsx)(x.p,{id:"datasetName",type:"text",value:r,onChange:e=>n(e.target.value),placeholder:"My Sales Data",className:"mt-1"})]}),(0,t.jsx)("div",{onDragOver:p,onDragLeave:h,onDrop:g,className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${d?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"}`,children:s?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:s.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[(s.size/1024).toFixed(2)," KB"]}),(0,t.jsx)("button",{type:"button",onClick:()=>a(null),className:"text-sm text-indigo-600 hover:text-indigo-500",children:"Remove"})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,t.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,t.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-indigo-600 hover:text-indigo-500",children:[(0,t.jsx)("span",{children:"Upload a file"}),(0,t.jsx)("input",{id:"file-upload",name:"file-upload",type:"file",accept:".csv",className:"sr-only",onChange:e=>{let s=e.target.files?.[0];s&&(a(s),r||n(s.name.replace(".csv","")))}})]}),(0,t.jsx)("span",{className:"pl-1",children:"or drag and drop"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"CSV files only"})]})}),m.isError&&(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,t.jsx)("p",{className:"text-sm text-red-800",children:m.error instanceof Error?m.error.message:"Upload failed. Please try again."})}),(0,t.jsx)(l.$,{type:"submit",className:"w-full",disabled:!s||m.isPending,children:m.isPending?"Uploading...":"Upload Dataset"})]})]})}function p(){let{data:e,isLoading:s,error:a}=(0,i.hS)(),r=(0,i.f7)();if(s)return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Loading datasets..."})});if(a)return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsx)("p",{className:"text-red-600",children:"Failed to load datasets"})});let n=Array.isArray(e)?e:[];if(0===n.length)return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsx)("p",{className:"text-gray-500 text-center",children:"No datasets yet. Upload your first CSV file to get started!"})});let d=e=>{switch(e){case"READY":return"bg-green-100 text-green-800";case"PROCESSING":return"bg-yellow-100 text-yellow-800";case"FAILED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},o=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),x=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":(e/1048576).toFixed(2)+" MB";return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Your Datasets"})}),(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:n.map(e=>(0,t.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("h4",{className:"text-base font-medium text-gray-900",children:e.name}),(0,t.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${d(e.status)}`,children:e.status})]}),(0,t.jsxs)("div",{className:"mt-1 flex items-center space-x-4 text-sm text-gray-500",children:[(0,t.jsx)("span",{children:e.fileName}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:x(e.fileSize)}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:[e.rowCount.toLocaleString()," rows"]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Uploaded ",o(e.createdAt)]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:["READY"===e.status&&(0,t.jsx)(c.default,{href:`/analytics/${e.id}`,children:(0,t.jsx)(l.$,{variant:"default",size:"sm",children:"View Analytics"})}),(0,t.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>r.mutate(e.id),disabled:r.isPending,children:r.isPending?"Deleting...":"Delete"})]})]})},e.id))})]})}function h(){let{user:e,isAuthenticated:s}=(0,r.n)(),a=(0,n.Wn)();(0,d.useRouter)();let[x,u]=(0,o.useState)(!1),{refetch:h}=(0,i.hS)();return x&&s&&e?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("nav",{className:"bg-white shadow-sm",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,t.jsx)(c.default,{href:"/dashboard",children:(0,t.jsx)("h1",{className:"text-2xl font-bold text-indigo-600",children:"SalesScope"})}),(0,t.jsxs)("nav",{className:"flex space-x-4",children:[(0,t.jsx)(c.default,{href:"/dashboard",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Dashboard"}),(0,t.jsx)(c.default,{href:"/datasets",className:"text-indigo-600 px-3 py-2 rounded-md text-sm font-medium bg-indigo-50",children:"Datasets"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["Welcome, ",e.name,"!"]}),(0,t.jsx)(l.$,{variant:"outline",onClick:()=>a.mutate(),disabled:a.isPending,children:a.isPending?"Logging out...":"Logout"})]})]})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Manage Your Datasets"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)(m,{onSuccess:()=>{h()}})}),(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsx)(p,{})})]})]})})]}):null}},91922:(e,s,a)=>{"use strict";a.d(s,{EL:()=>o,Zj:()=>l,f7:()=>c,hS:()=>d});var t=a(47782),r=a(64744),n=a(6763),i=a(58792);function l(){let e=(0,t.jE)();return(0,r.n)({mutationFn:async e=>{let s=new FormData;s.append("file",e.file),s.append("name",e.name);let a=await i.u.uploadDataset(s);if(!a.success)throw Error("Upload failed");return a.data},onSuccess:()=>{e.invalidateQueries({queryKey:["datasets"]})}})}function d(e=1,s=20){return(0,n.I)({queryKey:["datasets",e,s],queryFn:async()=>{let a=await i.u.listDatasets(e,s);if(!a.success)throw Error("Failed to fetch datasets");return a.data}})}function o(e){return(0,n.I)({queryKey:["dataset",e],queryFn:async()=>{let s=await i.u.getDataset(e);if(!s.success)throw Error("Failed to fetch dataset");return s.data},enabled:!!e})}function c(){let e=(0,t.jE)();return(0,r.n)({mutationFn:async e=>{if(!(await i.u.deleteDataset(e)).success)throw Error("Delete failed")},onSuccess:()=>{e.invalidateQueries({queryKey:["datasets"]})}})}},61381:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(96641).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/bastienverdier-vaissiere/Documents/Baverdie/Code/Projet Pro/SalesScope/apps/web/src/app/datasets/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/bastienverdier-vaissiere/Documents/Baverdie/Code/Projet Pro/SalesScope/apps/web/src/app/datasets/page.tsx","default")}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[292,624,390,113],()=>a(14503));module.exports=t})();