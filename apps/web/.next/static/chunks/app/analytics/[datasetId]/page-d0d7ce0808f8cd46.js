(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87],{35867:(e,t,a)=>{Promise.resolve().then(a.bind(a,52784))},52784:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>en});var s=a(39046),n=a(67495),r=a(82014),i=a(69183),l=a(45128),o=a(94009),c=a(14950),d=a(91196);function u(e){let{title:t,value:a,subtitle:n,icon:r,formatValue:i=!1}=e,l="string"==typeof a?a:i?a.toLocaleString():a;return(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:t}),(0,s.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:l}),n&&(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:n})]}),r&&(0,s.jsx)("div",{className:"text-indigo-600",children:r})]})})}var m=a(12298),h=a(54370),g=a(6115),x=a(82963),p=a(19104),f=a(25372),y=a(46725),v=a(39948);let j=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),w=e=>e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(0),"K"):"$".concat(e.toFixed(0)),b=e=>{if(10===e.length)return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"});if(7===e.length){let[t,a]=e.split("-");return new Date(parseInt(t),parseInt(a)-1).toLocaleDateString("en-US",{year:"numeric",month:"short"})}return e},N=e=>{if(0===e.length)return"Monthly";let t=e[0].date;return 10===t.length?"Daily":7===t.length?"Monthly":"Weekly"};function D(e){let{data:t}=e,a=N(t);return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Revenue Over Time (",a,")"]}),(0,s.jsx)(m.u,{width:"100%",height:400,children:(0,s.jsxs)(h.b,{data:t,margin:{top:5,right:30,left:20,bottom:60},children:[(0,s.jsx)(g.d,{strokeDasharray:"3 3"}),(0,s.jsx)(x.W,{dataKey:"date",tickFormatter:b,tick:{fontSize:11},angle:-45,textAnchor:"end",height:80,interval:"preserveStartEnd"}),(0,s.jsx)(p.h,{tickFormatter:w,tick:{fontSize:12},domain:["auto","auto"],allowDataOverflow:!1}),(0,s.jsx)(f.m,{formatter:e=>j(e),labelFormatter:b,labelStyle:{color:"#000",fontWeight:"bold"},contentStyle:{backgroundColor:"white",border:"1px solid #ccc"}}),(0,s.jsx)(y.s,{wrapperStyle:{paddingTop:"20px"}}),(0,s.jsx)(v.N,{type:"monotone",dataKey:"revenue",stroke:"#4f46e5",strokeWidth:3,name:"Revenue",dot:{r:5,fill:"#4f46e5"},activeDot:{r:7}})]})})]})}var S=a(6459),F=a(81632);let k=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),R=e=>e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(0),"K"):"$".concat(e.toFixed(0));function L(e){let{data:t}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Revenue by Category"}),(0,s.jsx)(m.u,{width:"100%",height:300,children:(0,s.jsxs)(S.E,{data:t,children:[(0,s.jsx)(g.d,{strokeDasharray:"3 3"}),(0,s.jsx)(x.W,{dataKey:"category",tick:{fontSize:12}}),(0,s.jsx)(p.h,{tickFormatter:R,tick:{fontSize:12}}),(0,s.jsx)(f.m,{formatter:e=>k(e),labelStyle:{color:"#000"}}),(0,s.jsx)(y.s,{}),(0,s.jsx)(F.y,{dataKey:"revenue",fill:"#4f46e5",name:"Revenue"})]})})]})}let T=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),P=e=>e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(0),"K"):"$".concat(e.toFixed(0));function E(e){let{data:t}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Top 10 Products by Revenue"}),(0,s.jsx)(m.u,{width:"100%",height:400,children:(0,s.jsxs)(S.E,{data:t,layout:"vertical",children:[(0,s.jsx)(g.d,{strokeDasharray:"3 3"}),(0,s.jsx)(x.W,{type:"number",tickFormatter:P,tick:{fontSize:12}}),(0,s.jsx)(p.h,{dataKey:"product",type:"category",width:150,tick:{fontSize:11}}),(0,s.jsx)(f.m,{formatter:e=>T(e),labelStyle:{color:"#000"}}),(0,s.jsx)(F.y,{dataKey:"revenue",fill:"#10b981",name:"Revenue"})]})})]})}function q(e){let{selected:t,onChange:a}=e;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Time Period:"}),(0,s.jsx)("div",{className:"flex space-x-2",children:[{value:"all",label:"All Time"},{value:"12m",label:"Last 12 Months"},{value:"6m",label:"Last 6 Months"},{value:"3m",label:"Last 3 Months"},{value:"1m",label:"Last Month"}].map(e=>(0,s.jsx)(d.$,{variant:t===e.value?"default":"outline",size:"sm",onClick:()=>a(e.value),children:e.label},e.value))})]})}var C=a(40646),A=a(52537),U=a(5506),I=a(62383),M=a(76948),K=a(89388),z=a(67778);function O(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,z.QP)((0,K.$)(t))}let $=A.bL;A.YJ;let B=A.WT,W=C.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(A.l9,{ref:t,className:O("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[n,(0,s.jsx)(A.In,{asChild:!0,children:(0,s.jsx)(U.A,{className:"h-4 w-4 opacity-50"})})]})});W.displayName=A.l9.displayName;let _=C.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(A.PP,{ref:t,className:O("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(I.A,{className:"h-4 w-4"})})});_.displayName=A.PP.displayName;let G=C.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(A.wn,{ref:t,className:O("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(U.A,{className:"h-4 w-4"})})});G.displayName=A.wn.displayName;let J=C.forwardRef((e,t)=>{let{className:a,children:n,position:r="popper",...i}=e;return(0,s.jsx)(A.ZL,{children:(0,s.jsxs)(A.UC,{ref:t,className:O("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...i,children:[(0,s.jsx)(_,{}),(0,s.jsx)(A.LM,{className:O("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(G,{})]})})});J.displayName=A.UC.displayName,C.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(A.JU,{ref:t,className:O("px-2 py-1.5 text-sm font-semibold",a),...n})}).displayName=A.JU.displayName;let Q=C.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(A.q7,{ref:t,className:O("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(A.VF,{children:(0,s.jsx)(M.A,{className:"h-4 w-4"})})}),(0,s.jsx)(A.p4,{children:n})]})});function V(e){let{categories:t,selected:a,onChange:n}=e;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Category:"}),(0,s.jsxs)($,{value:a||"all",onValueChange:e=>n("all"===e?void 0:e),children:[(0,s.jsx)(W,{className:"w-48",children:(0,s.jsx)(B,{placeholder:"All Categories"})}),(0,s.jsxs)(J,{children:[(0,s.jsx)(Q,{value:"all",children:"All Categories"}),t.map(e=>(0,s.jsx)(Q,{value:e,children:e},e))]})]})]})}function Y(e){let{products:t,selected:a,onChange:n}=e;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Product:"}),(0,s.jsxs)($,{value:a||"all",onValueChange:e=>n("all"===e?void 0:e),children:[(0,s.jsx)(W,{className:"w-48",children:(0,s.jsx)(B,{placeholder:"All Products"})}),(0,s.jsxs)(J,{children:[(0,s.jsx)(Q,{value:"all",children:"All Products"}),t.map(e=>(0,s.jsx)(Q,{value:e,children:e},e))]})]})]})}Q.displayName=A.q7.displayName,C.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(A.wv,{ref:t,className:O("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=A.wv.displayName;var Z=a(53413),H=a(22120),X=a(29060),ee=a(45227),et=a(242),ea=a.n(et);async function es(e){let{datasetName:t,fileName:a,filters:s}=e,n=new ee.Ay("p","mm","a4"),r=n.internal.pageSize.getWidth(),i=n.internal.pageSize.getHeight(),l=20;n.setFontSize(24),n.setFont("helvetica","bold"),n.text("Sales Analytics Report",r/2,l,{align:"center"}),l+=10,n.setFontSize(14),n.setFont("helvetica","normal"),n.text(t,r/2,l,{align:"center"}),l+=10;let o=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});if(n.setFontSize(10),n.setTextColor(100),n.text("Generated on ".concat(o),r/2,l,{align:"center"}),l+=15,s){let e=[];s.dateFilter&&"all"!==s.dateFilter&&e.push("Period: ".concat({"12m":"Last 12 Months","6m":"Last 6 Months","3m":"Last 3 Months","1m":"Last Month"}[s.dateFilter])),s.category&&e.push("Category: ".concat(s.category)),s.product&&e.push("Product: ".concat(s.product)),e.length>0&&(n.setFontSize(9),n.setTextColor(60),n.text("Active Filters:",15,l),l+=5,e.forEach(e=>{n.text("  • ".concat(e),20,l),l+=5}),l+=5)}n.setTextColor(0);let c=document.getElementById("kpis-section");if(c){let e=await ea()(c,{scale:2,backgroundColor:"#ffffff"}),t=e.toDataURL("image/png"),a=r-30,s=e.height*a/e.width;l+s>i-20&&(n.addPage(),l=20),n.addImage(t,"PNG",15,l,a,s),l+=s+10}let d=document.getElementById("revenue-chart");if(d){l+100>i-20&&(n.addPage(),l=20);let e=await ea()(d,{scale:2,backgroundColor:"#ffffff"}),t=e.toDataURL("image/png"),a=r-30,s=e.height*a/e.width;n.addImage(t,"PNG",15,l,a,s),l+=s+10}let u=document.getElementById("category-chart");if(u){l+80>i-20&&(n.addPage(),l=20);let e=await ea()(u,{scale:2,backgroundColor:"#ffffff"}),t=e.toDataURL("image/png"),a=(r-35)/2,s=e.height*a/e.width;n.addImage(t,"PNG",15,l,a,s)}let m=document.getElementById("product-chart");if(m){let e=await ea()(m,{scale:2,backgroundColor:"#ffffff"}),t=e.toDataURL("image/png"),a=(r-35)/2,s=e.height*a/e.width;n.addImage(t,"PNG",r/2+2.5,l,a,s)}n.save(a)}function en(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),{user:a,isAuthenticated:m}=(0,r.n)(),h=(0,i.Wn)(),[g,x]=(0,C.useState)(!1),[p,f]=(0,C.useState)("all"),[y,v]=(0,C.useState)(void 0),[j,w]=(0,C.useState)(void 0),[b,N]=(0,C.useState)(!1),S=async()=>{if(R){N(!0);try{await es({datasetName:R.name,fileName:"".concat(R.name.replace(/\s+/g,"_"),"_analytics.pdf"),filters:{dateFilter:p,category:y,product:j}})}catch(e){console.error("Failed to export PDF:",e),alert("Failed to export PDF. Please try again.")}finally{N(!1)}}},F=e.datasetId,k={...function(e){let t;let a=new Date,s=a.toISOString().split("T")[0];if("all"===e)return{};switch(e){case"1m":(t=new Date(a)).setMonth(a.getMonth()-1);break;case"3m":(t=new Date(a)).setMonth(a.getMonth()-3);break;case"6m":(t=new Date(a)).setMonth(a.getMonth()-6);break;case"12m":(t=new Date(a)).setFullYear(a.getFullYear()-1);break;default:return{}}return{startDate:t.toISOString().split("T")[0],endDate:s}}(p),category:y,product:j},{data:R,isLoading:T}=(0,l.EL)(F),{data:P,isLoading:A}=(0,o.I)({queryKey:["analytics",F,"filters"],queryFn:async()=>{let e=await c.u.getAvailableFilters(F);if(!e.success)throw Error("Failed to fetch filters");return e.data},enabled:!!F}),{data:U,isLoading:I}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.I)({queryKey:["analytics",e,"kpis",t],queryFn:async()=>{let a=await c.u.getKPIs(e,t);if(!a.success)throw Error("Failed to fetch KPIs");return a.data},enabled:!!e})}(F,k),{data:M,isLoading:K}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.I)({queryKey:["analytics",e,"revenue-by-date",t],queryFn:async()=>{let a=await c.u.getRevenueByDate(e,t);if(!a.success)throw Error("Failed to fetch revenue by date");return a.data},enabled:!!e})}(F,k),{data:z,isLoading:O}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.I)({queryKey:["analytics",e,"revenue-by-category",t],queryFn:async()=>{let a=await c.u.getRevenueByCategory(e,t);if(!a.success)throw Error("Failed to fetch revenue by category");return a.data},enabled:!!e})}(F,k),{data:$,isLoading:B}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.I)({queryKey:["analytics",e,"revenue-by-product",t],queryFn:async()=>{let a=await c.u.getRevenueByProduct(e,t);if(!a.success)throw Error("Failed to fetch revenue by product");return a.data},enabled:!!e})}(F,k);if((0,C.useEffect)(()=>{x(!0)},[]),(0,C.useEffect)(()=>{g&&!m&&t.push("/login")},[g,m,t]),!g||!m||!a)return null;let W=T||I||K||O||B,_="all"!==p||y||j;return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("nav",{className:"bg-white shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,s.jsx)(Z.default,{href:"/dashboard",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-indigo-600",children:"SalesScope"})}),(0,s.jsxs)("nav",{className:"flex space-x-4",children:[(0,s.jsx)(Z.default,{href:"/dashboard",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Dashboard"}),(0,s.jsx)(Z.default,{href:"/datasets",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Datasets"}),(0,s.jsx)("span",{className:"text-indigo-600 px-3 py-2 rounded-md text-sm font-medium bg-indigo-50",children:"Analytics"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-700",children:["Welcome, ",a.name,"!"]}),(0,s.jsx)(d.$,{variant:"outline",onClick:()=>h.mutate(),disabled:h.isPending,children:h.isPending?"Logging out...":"Logout"})]})]})})}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(Z.default,{href:"/datasets",className:"text-indigo-600 hover:text-indigo-500 text-sm font-medium",children:"← Back to Datasets"}),(0,s.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mt-2",children:(null==R?void 0:R.name)||"Analytics"}),(0,s.jsxs)("p",{className:"text-gray-600 mt-1",children:[null==R?void 0:R.fileName," • ",null==R?void 0:R.rowCount," rows"]})]}),(0,s.jsxs)(d.$,{onClick:S,disabled:b||W,size:"lg",children:[(0,s.jsx)(X.A,{className:"w-4 h-4 mr-2"}),b?"Exporting...":"Export PDF"]})]})}),(0,s.jsxs)("div",{className:"mb-6 bg-white rounded-lg shadow p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,s.jsx)(q,{selected:p,onChange:f}),!A&&P&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V,{categories:P.categories,selected:y,onChange:v}),(0,s.jsx)(Y,{products:P.products,selected:j,onChange:w})]}),_&&(0,s.jsxs)(d.$,{variant:"ghost",size:"sm",onClick:()=>{f("all"),v(void 0),w(void 0)},className:"ml-auto",children:[(0,s.jsx)(H.A,{className:"w-4 h-4 mr-1"}),"Clear Filters"]})]}),_&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Active filters:"}),"all"!==p&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:["12m"===p&&"Last 12 Months","6m"===p&&"Last 6 Months","3m"===p&&"Last 3 Months","1m"===p&&"Last Month"]}),y&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Category: ",y]}),j&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Product: ",j]})]})]}),W?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Loading analytics..."})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{id:"kpis-section",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(u,{title:"Total Revenue",value:"$".concat((null==U?void 0:U.totalRevenue.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00")}),(0,s.jsx)(u,{title:"Average Revenue",value:"$".concat((null==U?void 0:U.averageRevenue.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00")}),(0,s.jsx)(u,{title:"Total Sales",value:(null==U?void 0:U.totalSales.toLocaleString())||"0"}),(0,s.jsx)(u,{title:"Total Quantity",value:(null==U?void 0:U.totalQuantity.toLocaleString())||"0"})]}),M&&M.length>0&&(0,s.jsx)("div",{id:"revenue-chart",children:(0,s.jsx)(D,{data:M})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[z&&z.length>0&&(0,s.jsx)("div",{id:"category-chart",children:(0,s.jsx)(L,{data:z})}),$&&$.length>0&&(0,s.jsx)("div",{id:"product-chart",children:(0,s.jsx)(E,{data:$})})]})]})]})})]})}},91196:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var s=a(39046);let n=a(40646).forwardRef((e,t)=>{let{className:a="",variant:n="default",size:r="default",...i}=e;return(0,s.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"," ").concat({default:"bg-[#4F46E5] text-primary-foreground hover:bg-[#4F46E5]/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground"}[n]," ").concat({default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8"}[r]," ").concat(a),ref:t,...i})});n.displayName="Button"},69183:(e,t,a)=>{"use strict";a.d(t,{LR:()=>l,Wn:()=>c,vz:()=>o});var s=a(41255),n=a(67495),r=a(14950),i=a(82014);function l(){let e=(0,n.useRouter)(),{setTokens:t,setUser:a}=(0,i.n)();return(0,s.n)({mutationFn:async e=>{let t=await r.u.register(e);if(!t.success||!t.data)throw Error("Registration failed");return t.data},onSuccess:async s=>{r.u.setAccessToken(s.accessToken),t(s.accessToken,"");let n=await r.u.getCurrentUser();n.success&&n.data&&(a(n.data),e.push("/dashboard"))}})}function o(){let e=(0,n.useRouter)(),{setTokens:t,setUser:a}=(0,i.n)();return(0,s.n)({mutationFn:async e=>{let t=await r.u.login(e);if(!t.success||!t.data)throw Error("Login failed");return t.data},onSuccess:async s=>{r.u.setAccessToken(s.accessToken),t(s.accessToken,"");let n=await r.u.getCurrentUser();n.success&&n.data&&(a(n.data),e.push("/dashboard"))}})}function c(){let e=(0,n.useRouter)(),t=(0,i.n)(e=>e.logout);return(0,s.n)({mutationFn:async()=>{await r.u.logout()},onSuccess:()=>{r.u.setAccessToken(null),t(),e.push("/login")}})}},45128:(e,t,a)=>{"use strict";a.d(t,{EL:()=>c,Zj:()=>l,f7:()=>d,hS:()=>o});var s=a(73582),n=a(41255),r=a(94009),i=a(14950);function l(){let e=(0,s.jE)();return(0,n.n)({mutationFn:async e=>{let t=new FormData;t.append("file",e.file),t.append("name",e.name);let a=await i.u.uploadDataset(t);if(!a.success)throw Error("Upload failed");return a.data},onSuccess:()=>{e.invalidateQueries({queryKey:["datasets"]})}})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(0,r.I)({queryKey:["datasets",e,t],queryFn:async()=>{let a=await i.u.listDatasets(e,t);if(!a.success)throw Error("Failed to fetch datasets");return a.data}})}function c(e){return(0,r.I)({queryKey:["dataset",e],queryFn:async()=>{let t=await i.u.getDataset(e);if(!t.success)throw Error("Failed to fetch dataset");return t.data},enabled:!!e})}function d(){let e=(0,s.jE)();return(0,n.n)({mutationFn:async e=>{if(!(await i.u.deleteDataset(e)).success)throw Error("Delete failed")},onSuccess:()=>{e.invalidateQueries({queryKey:["datasets"]})}})}},14950:(e,t,a)=>{"use strict";a.d(t,{u:()=>n});class s{setAccessToken(e){this.accessToken=e}getAccessToken(){return this.accessToken}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="".concat(this.baseURL).concat(e),s={...t.headers};t.body&&(s["Content-Type"]="application/json"),this.accessToken&&(s.Authorization="Bearer ".concat(this.accessToken));let n={...t,headers:s,credentials:"include"},r=await fetch(a,n);if(!r.ok){var i;throw Error((null===(i=(await r.json().catch(()=>({error:{code:"UNKNOWN_ERROR",message:"An unknown error occurred"}}))).error)||void 0===i?void 0:i.message)||"Request failed")}return r.json()}async register(e){return this.request("/api/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){return this.request("/api/auth/login",{method:"POST",body:JSON.stringify(e)})}async refresh(){return this.request("/api/auth/refresh",{method:"POST"})}async logout(){return this.request("/api/auth/logout",{method:"POST"})}async getCurrentUser(){return this.request("/api/auth/me")}async uploadDataset(e){let t="".concat(this.baseURL,"/api/datasets/upload"),a={};this.accessToken&&(a.Authorization="Bearer ".concat(this.accessToken));let s=await fetch(t,{method:"POST",headers:a,credentials:"include",body:e});if(!s.ok){var n;throw Error((null===(n=(await s.json().catch(()=>({error:{code:"UNKNOWN_ERROR",message:"An unknown error occurred"}}))).error)||void 0===n?void 0:n.message)||"Upload failed")}return s.json()}async listDatasets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.request("/api/datasets?page=".concat(e,"&limit=").concat(t))}async getDataset(e){return this.request("/api/datasets/".concat(e))}async deleteDataset(e){return this.request("/api/datasets/".concat(e),{method:"DELETE"})}async getKPIs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/kpis").concat(s?"?".concat(s):""))}async getRevenueByDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/revenue-by-date").concat(s?"?".concat(s):""))}async getRevenueByCategory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/revenue-by-category").concat(s?"?".concat(s):""))}async getRevenueByProduct(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/revenue-by-product").concat(s?"?".concat(s):""))}async getAvailableFilters(e){return this.request("/api/analytics/".concat(e,"/filters"))}async getOverview(){return this.request("/api/analytics/overview")}async getDatasetsSummary(){return this.request("/api/analytics/datasets-summary")}async getTrends(){return this.request("/api/analytics/trends")}constructor(e){this.accessToken=null,this.baseURL=e}}let n=new s("http://localhost:3002")},82014:(e,t,a)=>{"use strict";a.d(t,{n:()=>r});var s=a(23170),n=a(2006);let r=(0,s.v)()((0,n.Zr)(e=>({accessToken:null,refreshToken:null,user:null,isAuthenticated:!1,setTokens:(t,a)=>e({accessToken:t,refreshToken:a,isAuthenticated:!0}),setUser:t=>e({user:t}),logout:()=>e({accessToken:null,refreshToken:null,user:null,isAuthenticated:!1})}),{name:"auth-storage"}))}},e=>{var t=t=>e(e.s=t);e.O(0,[6,906,294,948,502,558,909,735,563,787,358],()=>t(35867)),_N_E=e.O()}]);