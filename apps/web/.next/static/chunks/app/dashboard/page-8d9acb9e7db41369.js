(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{85487:(e,t,a)=>{Promise.resolve().then(a.bind(a,33329))},33329:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var s=a(39046),r=a(82014),n=a(69183),l=a(91196),c=a(67495),i=a(40646),o=a(53413),d=a(94009),u=a(14950),h=a(83648);let m=(0,h.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),x=(0,h.A)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),g=(0,h.A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),y=(0,h.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);function p(e){var t,a,r,n,l,c,i,o,d;let u;let{overview:h}=e;if(!h)return null;let p=e=>new Intl.NumberFormat("en-US").format(e),v=[{label:"Total Revenue",value:(u=null!==(r=h.totalRevenue)&&void 0!==r?r:0,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(u)),icon:m,color:"text-green-600",bgColor:"bg-green-50",subtext:"".concat(p(null!==(n=null===(t=h.recentActivity)||void 0===t?void 0:t.last30Days)&&void 0!==n?n:0)," sales last 30 days")},{label:"Total Sales",value:p(null!==(l=h.totalSales)&&void 0!==l?l:0),icon:x,color:"text-blue-600",bgColor:"bg-blue-50",subtext:"".concat(p(null!==(c=null===(a=h.recentActivity)||void 0===a?void 0:a.last7Days)&&void 0!==c?c:0)," sales last 7 days")},{label:"Datasets",value:"".concat(null!==(i=h.datasetsReady)&&void 0!==i?i:0,"/").concat(null!==(o=h.totalDatasets)&&void 0!==o?o:0),icon:g,color:"text-purple-600",bgColor:"bg-purple-50",subtext:"".concat(null!==(d=h.datasetsReady)&&void 0!==d?d:0," ready to analyze")},{label:"Data Period",value:(()=>{var e,t;let a=null==h?void 0:null===(e=h.dateRange)||void 0===e?void 0:e.earliest,s=null==h?void 0:null===(t=h.dateRange)||void 0===t?void 0:t.latest;if(!a||!s)return"No data";let r=new Date(a).toLocaleDateString("en-US",{month:"short",year:"numeric"}),n=new Date(s).toLocaleDateString("en-US",{month:"short",year:"numeric"});return"".concat(r," - ").concat(n)})(),icon:y,color:"text-orange-600",bgColor:"bg-orange-50",subtext:"Date range covered"}];return(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:v.map(e=>{let t=e.icon;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)("div",{className:"".concat(e.bgColor," p-3 rounded-lg"),children:(0,s.jsx)(t,{className:"w-6 h-6 ".concat(e.color)})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:e.label}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.value}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:e.subtext})]})]},e.label)})})}let v=(0,h.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),b=(0,h.A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function f(e){let{datasets:t}=e,a=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),r=e=>new Intl.NumberFormat("en-US").format(e),n=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),c=e=>{switch(e){case"READY":return"bg-green-100 text-green-800";case"PROCESSING":return"bg-yellow-100 text-yellow-800";case"FAILED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return 0===t.length?null:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Your Datasets"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow hover:shadow-xl transition-shadow p-6 group",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate mb-1",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(v,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:n(e.updatedAt)})]})]}),(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(c(e.status)),children:e.status})]}),(0,s.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Revenue"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:a(e.stats.totalRevenue)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Sales"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:r(e.stats.totalSales)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Avg Order"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:a(e.stats.avgRevenue)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Data Points"}),(0,s.jsxs)("span",{className:"text-xs font-medium text-gray-700",children:[r(e.rowCount)," rows"]})]})]}),"READY"===e.status&&(0,s.jsx)(o.default,{href:"/analytics/".concat(e.id),children:(0,s.jsxs)(l.$,{className:"w-full group-hover:bg-primary group-hover:text-white transition",children:[(0,s.jsx)(m,{className:"w-4 h-4 mr-2"}),"View Analytics",(0,s.jsx)(b,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})}),"PROCESSING"===e.status&&(0,s.jsx)(l.$,{className:"w-full",disabled:!0,children:(0,s.jsx)("span",{className:"animate-pulse",children:"Processing..."})}),"FAILED"===e.status&&(0,s.jsx)(l.$,{className:"w-full",variant:"default",disabled:!0,children:"Processing Failed"})]},e.id))})]})}var j=a(12298),N=a(54370),w=a(6115),k=a(82963),D=a(19104),S=a(25372),R=a(39948);function A(e){let{data:t}=e,a=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),r=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),n=t.reduce((e,t)=>e+t.revenue,0),l=t.reduce((e,t)=>e+t.sales,0),c=n/t.length;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Revenue (30d)"}),(0,s.jsx)("p",{className:"text-xl font-bold text-gray-900",children:a(n)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Sales (30d)"}),(0,s.jsx)("p",{className:"text-xl font-bold text-gray-900",children:l.toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Avg Daily Revenue"}),(0,s.jsx)("p",{className:"text-xl font-bold text-gray-900",children:a(c)})]})]}),(0,s.jsx)(j.u,{width:"100%",height:250,children:(0,s.jsxs)(N.b,{data:t,margin:{top:5,right:20,bottom:5,left:0},children:[(0,s.jsx)(w.d,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,s.jsx)(k.W,{dataKey:"date",tickFormatter:r,stroke:"#9ca3af",tick:{fontSize:12},tickMargin:10}),(0,s.jsx)(D.h,{yAxisId:"revenue",orientation:"left",tickFormatter:a,stroke:"#10b981",tick:{fontSize:12},width:80}),(0,s.jsx)(D.h,{yAxisId:"sales",orientation:"right",stroke:"#3b82f6",tick:{fontSize:12},width:60}),(0,s.jsx)(S.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"12px"},formatter:(e,t)=>"revenue"===t?[a(e),"Revenue"]:[e.toLocaleString(),"Sales"],labelFormatter:e=>r(e)}),(0,s.jsx)(R.N,{yAxisId:"revenue",type:"monotone",dataKey:"revenue",stroke:"#10b981",strokeWidth:2,dot:!1,name:"revenue"}),(0,s.jsx)(R.N,{yAxisId:"sales",type:"monotone",dataKey:"sales",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"sales"})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-6 mt-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-1 bg-green-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Revenue (left axis)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-1 bg-blue-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Sales (right axis)"})]})]})]})}let T=(0,h.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);function U(){let{user:e,isAuthenticated:t}=(0,r.n)(),a=(0,n.Wn)(),h=(0,c.useRouter)(),[m,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{x(!0)},[]),(0,i.useEffect)(()=>{m&&!t&&h.push("/login")},[m,t,h]);let{data:g,isLoading:y}=(0,d.I)({queryKey:["analytics","overview"],queryFn:async()=>(await u.u.getOverview()).data,enabled:m&&t}),{data:v,isLoading:b}=(0,d.I)({queryKey:["analytics","datasets-summary"],queryFn:async()=>(await u.u.getDatasetsSummary()).data,enabled:m&&t}),{data:j,isLoading:N}=(0,d.I)({queryKey:["analytics","trends"],queryFn:async()=>(await u.u.getTrends()).data,enabled:m&&t});if(!m||!t||!e)return null;let w=y||b||N;return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("nav",{className:"bg-white shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,s.jsx)(o.default,{href:"/dashboard",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-indigo-600",children:"SalesScope"})}),(0,s.jsxs)("nav",{className:"flex space-x-4",children:[(0,s.jsx)(o.default,{href:"/dashboard",className:"text-indigo-600 px-3 py-2 rounded-md text-sm font-medium bg-indigo-50",children:"Dashboard"}),(0,s.jsx)(o.default,{href:"/datasets",className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Datasets"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-700",children:["Welcome, ",e.name,"!"]}),(0,s.jsx)(l.$,{variant:"outline",onClick:()=>a.mutate(),disabled:a.isPending,children:a.isPending?"Logging out...":"Logout"})]})]})})}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Overview of all your sales data"})]}),(0,s.jsx)(o.default,{href:"/datasets",children:(0,s.jsxs)(l.$,{children:[(0,s.jsx)(T,{className:"w-4 h-4 mr-2"}),"Upload CSV"]})})]}),w&&(0,s.jsxs)("div",{className:"animate-pulse space-y-8",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"h-32 bg-gray-200 rounded"},e))}),(0,s.jsx)("div",{className:"h-64 bg-gray-200 rounded"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"h-48 bg-gray-200 rounded"},e))})]}),!w&&(0,s.jsxs)(s.Fragment,{children:[g&&(0,s.jsx)(p,{overview:g}),j&&j.length>0&&(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Revenue Trend (Last 30 Days)"}),(0,s.jsx)(A,{data:j})]})}),v&&v.length>0&&(0,s.jsx)(f,{datasets:v}),v&&0===v.length&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,s.jsx)(T,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No datasets yet"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Upload your first CSV file to start analyzing your sales data"}),(0,s.jsx)(o.default,{href:"/datasets",children:(0,s.jsxs)(l.$,{size:"lg",children:[(0,s.jsx)(T,{className:"w-5 h-5 mr-2"}),"Upload Your First Dataset"]})})]})]})]})})]})}},91196:(e,t,a)=>{"use strict";a.d(t,{$:()=>r});var s=a(39046);let r=a(40646).forwardRef((e,t)=>{let{className:a="",variant:r="default",size:n="default",...l}=e;return(0,s.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"," ").concat({default:"bg-[#4F46E5] text-primary-foreground hover:bg-[#4F46E5]/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground"}[r]," ").concat({default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8"}[n]," ").concat(a),ref:t,...l})});r.displayName="Button"},69183:(e,t,a)=>{"use strict";a.d(t,{LR:()=>c,Wn:()=>o,vz:()=>i});var s=a(41255),r=a(67495),n=a(14950),l=a(82014);function c(){let e=(0,r.useRouter)(),{setTokens:t,setUser:a}=(0,l.n)();return(0,s.n)({mutationFn:async e=>{let t=await n.u.register(e);if(!t.success||!t.data)throw Error("Registration failed");return t.data},onSuccess:async s=>{n.u.setAccessToken(s.accessToken),t(s.accessToken,"");let r=await n.u.getCurrentUser();r.success&&r.data&&(a(r.data),e.push("/dashboard"))}})}function i(){let e=(0,r.useRouter)(),{setTokens:t,setUser:a}=(0,l.n)();return(0,s.n)({mutationFn:async e=>{let t=await n.u.login(e);if(!t.success||!t.data)throw Error("Login failed");return t.data},onSuccess:async s=>{n.u.setAccessToken(s.accessToken),t(s.accessToken,"");let r=await n.u.getCurrentUser();r.success&&r.data&&(a(r.data),e.push("/dashboard"))}})}function o(){let e=(0,r.useRouter)(),t=(0,l.n)(e=>e.logout);return(0,s.n)({mutationFn:async()=>{await n.u.logout()},onSuccess:()=>{n.u.setAccessToken(null),t(),e.push("/login")}})}},14950:(e,t,a)=>{"use strict";a.d(t,{u:()=>r});class s{setAccessToken(e){this.accessToken=e}getAccessToken(){return this.accessToken}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="".concat(this.baseURL).concat(e),s={...t.headers};t.body&&(s["Content-Type"]="application/json"),this.accessToken&&(s.Authorization="Bearer ".concat(this.accessToken));let r={...t,headers:s,credentials:"include"},n=await fetch(a,r);if(!n.ok){var l;throw Error((null===(l=(await n.json().catch(()=>({error:{code:"UNKNOWN_ERROR",message:"An unknown error occurred"}}))).error)||void 0===l?void 0:l.message)||"Request failed")}return n.json()}async register(e){return this.request("/api/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){return this.request("/api/auth/login",{method:"POST",body:JSON.stringify(e)})}async refresh(){return this.request("/api/auth/refresh",{method:"POST"})}async logout(){return this.request("/api/auth/logout",{method:"POST"})}async getCurrentUser(){return this.request("/api/auth/me")}async uploadDataset(e){let t="".concat(this.baseURL,"/api/datasets/upload"),a={};this.accessToken&&(a.Authorization="Bearer ".concat(this.accessToken));let s=await fetch(t,{method:"POST",headers:a,credentials:"include",body:e});if(!s.ok){var r;throw Error((null===(r=(await s.json().catch(()=>({error:{code:"UNKNOWN_ERROR",message:"An unknown error occurred"}}))).error)||void 0===r?void 0:r.message)||"Upload failed")}return s.json()}async listDatasets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.request("/api/datasets?page=".concat(e,"&limit=").concat(t))}async getDataset(e){return this.request("/api/datasets/".concat(e))}async deleteDataset(e){return this.request("/api/datasets/".concat(e),{method:"DELETE"})}async getKPIs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/kpis").concat(s?"?".concat(s):""))}async getRevenueByDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/revenue-by-date").concat(s?"?".concat(s):""))}async getRevenueByCategory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/revenue-by-category").concat(s?"?".concat(s):""))}async getRevenueByProduct(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URLSearchParams;t.startDate&&a.append("startDate",t.startDate),t.endDate&&a.append("endDate",t.endDate),t.category&&a.append("category",t.category),t.product&&a.append("product",t.product);let s=a.toString();return this.request("/api/analytics/".concat(e,"/revenue-by-product").concat(s?"?".concat(s):""))}async getAvailableFilters(e){return this.request("/api/analytics/".concat(e,"/filters"))}async getOverview(){return this.request("/api/analytics/overview")}async getDatasetsSummary(){return this.request("/api/analytics/datasets-summary")}async getTrends(){return this.request("/api/analytics/trends")}constructor(e){this.accessToken=null,this.baseURL=e}}let r=new s("http://localhost:3002")},82014:(e,t,a)=>{"use strict";a.d(t,{n:()=>n});var s=a(23170),r=a(2006);let n=(0,s.v)()((0,r.Zr)(e=>({accessToken:null,refreshToken:null,user:null,isAuthenticated:!1,setTokens:(t,a)=>e({accessToken:t,refreshToken:a,isAuthenticated:!0}),setUser:t=>e({user:t}),logout:()=>e({accessToken:null,refreshToken:null,user:null,isAuthenticated:!1})}),{name:"auth-storage"}))}},e=>{var t=t=>e(e.s=t);e.O(0,[948,502,558,909,563,787,358],()=>t(85487)),_N_E=e.O()}]);